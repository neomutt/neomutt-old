From: Antonio Radici <antonio@debian.org>
Date: Fri, 18 Sep 2015 11:48:47 +0200
Subject: 771125-CVE-2014-9116-jessie

This patch solves the issue raised by CVE-2014-9116 in bug 771125.

We correctly redefine what are the whitespace characters as per RFC5322; by
doing so we prevent mutt_substrdup from being used in a way that could lead to
a segfault.

The lib.c part was written by Antonio Radici <antonio@debian.org> to prevent
crashes due to this kind of bugs from happening again.

The wheezy version of this patch is slightly different, therefore this patch
has -jessie prefixed in its name.

The sendlib.c part was provided by Salvatore Bonaccorso and it is the same as
the upstream patch reported here:
http://dev.mutt.org/trac/attachment/ticket/3716/ticket-3716-stable.patch

Signed-off-by: Matteo F. Vescovi <mfv@debian.org>

To apply to neomutt by:
From b84a92fb81c49b79ff6c55e4d57de503a85d14e4 Mon Sep 17 00:00:00 2001
From: Richard Russon <rich@flatcap.org>
Date: Fri, 6 May 2016 00:24:03 +0100
Subject: [PATCH 19/22] upstream/771125-CVE-2014-9116-jessie

---
 lib.c | 3 +++
 1 file changed, 3 insertions(+)

Index: neomutt-20160818/lib.c
===================================================================
--- neomutt-20160818.orig/lib.c
+++ neomutt-20160818/lib.c
@@ -819,6 +819,9 @@ char *mutt_substrdup (const char *begin,
   size_t len;
   char *p;
 
+  if (end != NULL && end < begin)
+    return NULL;
+
   if (end)
     len = end - begin;
   else
